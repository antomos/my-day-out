
<% alternatives = Array.new %>
<% event.alternative_places["results"].first(5).each do |place| %>
  <% alternatives << place["name"] %>
<% end %>
<% coord = event.place.search_geometry_location.split(',') %>
<% @markers =
      [{
        lat: coord[0],
        lng: coord[1]

      }]
%>






<div class="d-flex flex-column card justify-content-center rounded" >
  <div class="col">
    <%# card image %>
    <div class="card-img rounded-top">
      <% if event.place.photo.attached? %>
        <%= cl_image_tag event.place.photo.key, style: "min-width:100px; min-height:200px" %>
      <% else %>
        <img src="https://res.cloudinary.com/danwlbu2c/image/upload/c_fill,h_300,w_400/v1/development/nm0x8y7ykna21y2h1w2gpxi0fto6" style= "min-width:40px; min-height:170px">
      <% end %>
    </div>

  <%# title  %>


    <div style="display:flex";>
      <%# edit form %>
      <div class="col d-none edit-form" data-edit-event-target="formdiv", style="min-width:150px; max-height:320px";>
        <button class= "x-button btn btn-pink border1" aria-label= Edit <%= event.place.name %> style="float: right";>
          <i class="fa-solid fa-xmark" data-action="click->edit-event#hideForm"></i>
        </button>
        <h2>Edit <strong><%= event.place.name %></strong></h2>
          <%= simple_form_for [itinerary,event],
            html: {

              # data: {

              #   edit_event_target: "form",
              #   action: "submit->edit-event#update"
              # }
            } do |f|
          %>
            <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
            <%= f.input :place, label: 'Swap with', collection: alternatives %>
            <%# <%= f.input :end_time, label: 'Change Duration',collection: [["30 mins", 30],["45 mins",45],["1h",60],["1h 15 mins",75],["1h 30 mins",90],["1h 45 mins",105],["2h",120]]%>
             <%= f.submit "Update event", class: "btn btn-sm btn-pink border2" %>
           <% end %>
      </div>
    </div>

    <%# details %>
    <div class="d-flex flex-column" style="min-width:170px; max-height: 475px"; >
        <div class="card-header">
          <h2><%= event.order_number %>. <%= event.place.name  %></h2>
          <small> ( <%= event.start_time  %> - <%= event.end_time  %>)</small>
        </div><br>
        <div>
          <p><%= event.place.details_overview %></p>
          <p><%= event.place.details_formatted_address %></p>
        </div>
        <div class="mb-2" style="width: 220px; height: 150px;"
            data-controller="map"
            data-map-markers-value="<%= @markers.to_json %>"
            data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>
        <div class="d-flex flex-row justify-content-evenly">
          <a href="<%= event.place.details_website %>" target="_blank"><i class="fa-solid fa-globe link-dec"></i></a></p>
          <p><%= link_to "Remove this event", remove_path(event), :class => "link-dec", data: {
                turbo_method: :get,
                turbo_confirm: "Are you sure you want to remove this event from your Itinerary? This cannot be undone."
                }
          %></p>
        </div>
        <button class="btn btn-pink border2" data-edit-event-target="button" data-action="click->edit-event#displayForm">
                Edit
        </button>
    </div>
  </div>


</div>
